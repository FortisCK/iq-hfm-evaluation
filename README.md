# IQ-HFM 专家评价系统

## 📖 项目简介

这是为TMI2025论文《IQ-HFM: Image-guided Quantized Hybrid Facial Modeling》设计的专家主观评价系统。该系统用于收集5名口腔颌面外科医师对跨模态面部重建结果的专业评价，评估几何精度、视觉真实感和临床价值。

### 🎯 核心特性

- **三重3D对比查看器**：同时展示CBCT、3dMD扫描和IQ-HFM重建的3D模型
- **智能案例分配**：为每位专家随机分配5个独特案例
- **多维度评价**：几何精度(GA)、视觉真实感(VR)、临床价值(CV)评分
- **数据收集**：本地存储 + JSON/CSV导出功能
- **管理员面板**：实时统计分析和ICC计算
- **响应式设计**：支持桌面端和移动端访问

## 🏗️ 项目结构

```
iq-hfm-evaluation/
├── index.html              # 主评价页面
├── admin.html              # 管理员查看结果页面
├── css/
│   └── style.css           # 样式文件
├── js/
│   ├── evaluation.js       # 评价系统核心逻辑
│   └── admin.js            # 管理员功能
├── models/                 # 3D模型文件目录
│   ├── subject_001_cbct.obj    # CBCT重建模型（需要添加）
│   ├── subject_001_3dmd.obj    # 3dMD真实扫描（需要添加）
│   ├── subject_001_iqhfm.obj   # IQ-HFM重建结果（需要添加）
│   └── ...                     # 其他案例的3种模型
└── README.md
```

## 🚀 快速开始

### 1. 准备数据文件

将您的3D模型文件放入 `models/` 目录，每个案例需要3个OBJ文件：

- **CBCT重建模型**：`subject_001_cbct.obj`, `subject_002_cbct.obj` 等
- **3dMD真实扫描**：`subject_001_3dmd.obj`, `subject_002_3dmd.obj` 等  
- **IQ-HFM重建结果**：`subject_001_iqhfm.obj`, `subject_002_iqhfm.obj` 等

### 2. 本地预览

打开终端，在项目根目录运行：

```bash
# 使用Python启动本地服务器
python3 -m http.server 8080
# 或使用Node.js
npx serve .
```

在浏览器访问 `http://localhost:8080`

### 3. GitHub Pages部署

1. 将项目推送到GitHub仓库
2. 在仓库Settings中启用GitHub Pages
3. 选择源分支（通常是main/master）
4. 获得访问链接：`https://yourusername.github.io/iq-hfm-evaluation/`

## 👩‍⚕️ 使用说明

### 专家评价流程

1. **专家信息登录**
   - 选择专家编号（1-5）
   - 填写临床经验年数（≥10年）

2. **案例评价**
   - 同时查看3个3D模型（每个都支持鼠标拖拽旋转、滚轮缩放）：
     - 原始CBCT切片的3D重建（白色显示）
     - 真实3dMD人脸扫描（肤色显示）
     - IQ-HFM跨模态重建结果（肤色显示）
   - 重点对比IQ-HFM结果与CBCT重建的改进效果
   - 完成三项评分（1-5分）：
     - 几何精度(GA)：保持CBCT精度同时面部比例的自然程度
     - 视觉真实感(VR)：相比纯CBCT重建的视觉提升程度
     - 临床价值(CV)：对临床工作的帮助程度
   - 勾选二元判断：适合诊断/有助沟通/有价值规划
   - 可选填写评论意见

3. **进度管理**
   - 系统自动保存评价进度
   - 支持前后案例导航
   - 实时显示完成进度

### 管理员功能

访问 `admin.html` 查看：

- **数据统计**：总评价数、参与专家数、平均评分、数据完整性
- **评分分析**：各维度的均值±标准差、中位数、范围
- **临床认可度**：二元判断的百分比统计  
- **专家详情**：按专家筛选查看详细评价数据
- **专家评论**：查看所有文字评论
- **一致性分析**：ICC值计算和解释
- **数据导出**：JSON格式汇总报告 + CSV格式原始数据

## 📊 评价维度说明

### 定量评分 (1-5分)

| 评分 | 几何精度(GA) | 视觉真实感(VR) | 临床价值(CV) |
|------|------------|-------------|------------|
| 5 | 完美保持CBCT精度，面部比例极其自然 | 相比CBCT显著提升，视觉效果优异 | 对临床工作帮助极大 |
| 4 | 很好保持精度，比例较为自然 | 相比CBCT明显提升，效果良好 | 对临床工作帮助较大 |
| 3 | 适当保持精度，比例基本合理 | 相比CBCT有一定提升，效果一般 | 对临床工作有一定帮助 |
| 2 | 精度保持一般，比例略有问题 | 相比CBCT提升有限，效果较差 | 对临床工作帮助有限 |
| 1 | 精度丢失严重，比例不自然 | 相比CBCT无明显提升或更差 | 对临床工作帮助很小 |

### 二元判断

- **适合用于诊断分析**：重建模型是否足够准确用于诊断
- **有助于与患者沟通**：是否能帮助医生向患者解释病情
- **有价值的手术规划**：是否对制定手术方案有帮助

## 🔒 数据安全

- 所有评价数据存储在浏览器本地
- 不会自动上传到任何服务器
- 管理员可主动导出数据进行分析
- 支持清除本地数据功能

## 🛠️ 技术栈

- **前端**：HTML5 + CSS3 + JavaScript (ES6+)
- **3D渲染**：Three.js r128
- **样式**：原生CSS（响应式设计）
- **数据存储**：localStorage
- **部署**：GitHub Pages

## 📈 预期结果

根据论文设计，预期获得以下统计结果：

- **几何精度(GA)**：4.1±0.6
- **视觉真实感(VR)**：4.4±0.5  
- **临床价值(CV)**：4.2±0.6
- **临床认可度**：诊断适合87%，沟通有助93%，规划有价值90%
- **一致性分析**：ICC = 0.823，p < 0.001

## 🤝 贡献指南

1. Fork 项目
2. 创建特性分支 (`git checkout -b feature/AmazingFeature`)
3. 提交更改 (`git commit -m 'Add some AmazingFeature'`)
4. 推送到分支 (`git push origin feature/AmazingFeature`)
5. 开启 Pull Request

## 📝 许可证

本项目仅用于学术研究，请遵循相关学术规范使用。

## 📧 联系方式

如有技术问题或建议，请通过GitHub Issues联系。

---

**注意事项**：
1. 确保3D模型文件大小适中（建议每个<5MB），以保证良好的加载体验
2. 每个案例需要3个OBJ文件：CBCT、3dMD和IQ-HFM重建模型
3. CBCT模型会显示为白色，其他模型显示为肤色
4. 系统设计用于Chrome、Firefox、Safari等现代浏览器
5. 移动端访问时建议横屏操作以获得最佳体验
6. 3个查看器独立操作，可以从不同角度对比模型细节 